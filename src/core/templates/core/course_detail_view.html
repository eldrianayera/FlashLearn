{% extends 'base.html' %}

{% block title %}
  {{ course.name }}
{% endblock %}

{% block content %}
  <div class="max-w-6xl mx-auto py-10 px-4">
    <!-- Breadcrumb -->
    <nav class="text-sm mb-6">
      <ol class="flex space-x-2 text-gray-500">
        <li>
          <a href="{% url 'courses' %}" class="hover:underline text-blue-600">Courses</a>
        </li>
        <li>/</li>
        <li class="text-gray-700 font-medium">{{ course.name }}</li>
      </ol>
    </nav>

    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
      <h1 class="text-2xl font-bold text-gray-900">{{ course.name }}</h1>
      <span class="text-sm text-gray-500">Created {{ course.created_at|date:'M d, Y' }}</span>
    </div>

    {% if course.course_note %}
      <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-4 mb-8">
        <p class="text-indigo-900">
          <span class="font-semibold">Note:</span> {{ course.course_note }}
        </p>
      </div>
    {% endif %}

    <!-- DOCUMENTS -->
    <section class="mb-10">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold">üìÑ Documents</h2>
        <span class="bg-blue-100 text-blue-700 text-sm font-medium px-2 py-1 rounded-full">{{ documents_count }}</span>
      </div>

      <div class="flex items-center justify-between mb-6">
        <div></div>
        <a href="{% url 'document-create' course.slug %}" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-600 text-white text-sm font-medium shadow hover:shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>Add new doc
        </a>
      </div>

      <div class="grid md:grid-cols-2 gap-6">
        {% for doc in course.documents.all %}
          <article class="group relative overflow-hidden rounded-2xl border border-gray-200 bg-white p-5 shadow-sm hover:shadow-md transition-all duration-200 hover:-translate-y-0.5">
            <!-- playful corner dots -->
            <div class="pointer-events-none absolute -right-8 -top-8 h-24 w-24 rounded-full bg-gradient-to-br from-pink-100 to-purple-100 opacity-60 blur-2xl"></div>

            <!-- Header -->
            <div class="flex items-start justify-between gap-3">
              <div class="min-w-0">
                <a href="{% url 'document-detail' doc.pk %}" class="inline-flex items-center gap-2">
                  <span class="text-2xl">üóÇÔ∏è</span>
                  <h3 class="text-lg font-semibold text-gray-900 hover:underline truncate">{{ doc.name }}</h3>
                </a>
                <p class="text-xs text-gray-500 mt-0.5">Added {{ doc.created_at|date:'M d, Y' }}</p>
              </div>
              <!-- Actions -->
              <div class="flex items-center gap-2 shrink-0">
                <!-- View button -->
                <a href="{% url 'document-detail' doc.pk %}" class="inline-flex items-center px-3 py-1.5 text-sm rounded-lg border border-gray-300 hover:bg-gray-50">View</a>

                <!-- Delete button -->
                <a href="{% url 'document-delete' doc.id %}" class="inline-flex items-center px-3 py-1.5 text-sm rounded-lg bg-red-500 text-white hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400" onclick="return confirm('Are you sure you want to delete this document?');">Delete</a>
              </div>
            </div>

            <!-- Stat chips -->
            <div class="mt-4 flex flex-wrap items-center gap-2 text-xs">
              <span class="inline-flex items-center gap-1 rounded-full bg-gray-100 px-2.5 py-1 text-gray-700">üß† Flashcards: <strong>{{ doc.flashcards.count }}</strong></span>
              <span class="inline-flex items-center gap-1 rounded-full bg-gray-100 px-2.5 py-1 text-gray-700">
                üìé File:
                <strong>
                  {% if doc.file %}
                    {{ doc.file.size|filesizeformat }}
                  {% else %}
                    None
                  {% endif %}
                </strong>
              </span>
              {% if doc.summary %}
                <span class="inline-flex items-center gap-1 rounded-full bg-green-100 px-2.5 py-1 text-green-800">‚úÖ Summary</span>
              {% endif %}
              {% if doc.document_note %}
                <span class="inline-flex items-center gap-1 rounded-full bg-blue-100 px-2.5 py-1 text-blue-800">üìù Note</span>
              {% endif %}
            </div>

            <!-- Preview rows (first few words only) -->
            <div class="mt-4 space-y-2 text-sm">
              {% if doc.summary %}
                <div class="rounded-lg bg-green-50 px-3 py-2 text-green-900 border border-green-100">
                  <span class="font-medium">Summary:</span>
                  <span class="opacity-90">{{ doc.summary|truncatewords:18 }}</span>
                </div>
              {% endif %}

              {% if doc.document_note %}
                <div class="rounded-lg bg-blue-50 px-3 py-2 text-blue-900 border border-blue-100">
                  <span class="font-medium">Note:</span>
                  <span class="opacity-90">{{ doc.document_note|truncatewords:18 }}</span>
                </div>
              {% endif %}
            </div>
          </article>
        {% empty %}
          <p class="text-gray-500 text-sm">No documents yet.</p>
        {% endfor %}
      </div>
    </section>

    <!-- Back link -->
    <div>
      <a href="{% url 'courses' %}" class="inline-block px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">‚Üê Back to Courses</a>
    </div>
  </div>
{% endblock %}
